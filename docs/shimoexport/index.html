<!DOCTYPE html><html lang=zh><head><meta charset=UTF-8 /><meta name=viewport content="width=device-width, initial-scale=1.0" /><title>戈登走過去的博客</title><style>body{margin:0;padding:0}header{text-align:center}#headerBar{background-color:#00f;color:#fff;padding:5px;font-weight:bold;margin-bottom:5px}#headerNav a{color:#00f;margin:4px;display:inline-block}section{margin:6px}.sectionTitleBox{text-align:center;margin-bottom:5px}#randomSaying{text-align:center}#friendLinksBox{text-align:center}.friendslink{display:inline-block;padding:4px;text-decoration:none;font-weight:bold;font-size:large;margin:4px}.secitonNavBox{max-width:500px;margin-left:auto;margin-right:auto}.secitonNavBox a{color:#00f;margin-bottom:4px;display:table;padding:3px}article{max-width:700px;margin-left:auto;margin-right:auto;padding:4px}article h1{text-align:center}</style></head><body><main><header><div id=headerBar>戈登走過去的博客</div><nav id=headerNav><a href=/>首页</a> <a href=/>RSS</a> <a href=/>关于戈登登</a> <a href=/>捐助戈登登</a> <a href=/>联系戈登登</a></nav></header><section><div class=sectionTitleBox><span class=sectionTitle></span></div></section><article><h1>石墨文档批量导出脚本</h1><time datetime=2021-03-19>本文发布于公元 2021 年 03 月 19 日</time><p>这是一个 Tampermonkey 脚本。</p><p>石墨文档无疑是我用过的最好用的在线文档之一。<br /> 但是他不提供批量导出功能，提高了自备份数据、转移数据的门槛。<br /> （说实话国内一堆网站都这幅德行，数据不方便备份的话，一旦账号被封或者服务器异常，抢救会很困难）</p><p>我写了这个脚本，虽然可以一键导出，但是<strong>因为石墨官方的限制，速度完全不合理</strong>。<br /> 石墨官方的速度限制是一分钟内最多可以导出6个文件。<br /> 当你导出第一个文件的时候，他就会开始监测，当你导出6个，试着导出第7个的时候，他会说：“请你等待xx秒。”<br /> 既然官方有限制，我就尽量模拟真人操作，每导出一个就会暂停3秒。</p><p>你手动点导出也一样，你很快就导出了6个，然后再点导出什么都不发生了，得等几十秒之后才行。</p><h2>源码、下载</h2><p><a href=https://github.com/gordonwalkedby/shimo-export>github</a></p><h2>截图</h2><p><img src=https://s3.ax1x.com/2021/03/19/6R7YkV.png alt=截图afda /><br /><img src=https://s3.ax1x.com/2021/03/19/6RhDmV.png alt=截图gfdfhd /><br /><img src=https://s3.ax1x.com/2021/03/19/6RhPQ1.png alt=截图0dfhgdh2 /><br /><img src=https://s3.ax1x.com/2021/03/19/6RhtYQ.png alt=截图gfhhte3 /></p></article></main><script>"use strict";function RandomInt(n,t){if(n==t)return Math.floor(n);let i=Math.round(Math.min(n,t))-.49,r=Math.round(Math.max(n,t))+.49,u=Math.random();return Math.round(u*(r-i)+i)}function RandomChoose(n){let t=n.length;if(t<2)return n[0];let i=RandomInt(0,t-1);return n[i]}function RandomHSLColor(n=100,t=85){let i="hsl(";return i+=RandomInt(0,359).toFixed()+",",i+=n.toFixed()+"%,",i+(t.toFixed()+"%)")}function AddFriendsLink(n,t){let r=document.getElementById("friendLinksBox"),i=document.createElement("a");i.href=t;i.title=n;i.target="_blank";i.className="friendslink";i.innerText=n;let u="linear-gradient(to "+RandomChoose(["bottom","right"])+","+RandomHSLColor()+"0%,"+RandomHSLColor()+"50%,"+RandomHSLColor()+"52%,"+RandomHSLColor()+"100%)";i.style.background=u;i.style.color=RandomHSLColor(100,11);r.appendChild(i)}(function(){let n=document.getElementsByClassName("sectionTitle"),t=Math.min(400,window.innerWidth*.7);for(let i=0;i<n.length;i++){let r=n[i],u=r.innerText;for(let n=0;n<50;n++)if(u="+"+u+"+",r.innerText=u,r.offsetWidth>t)break}})(),function(){let n=[];n.push({k:"技术宅的结界",v:"https://www.0xaa55.com/"});n.push({k:"AceSheep",v:"https://blog.acesheep.com/"});n.push({k:"Sonic853",v:"https://blog.853lab.com/"});let t=n.length;for(let i=0;i<t;i++){let t=RandomInt(0,n.length-1),i=n[t];n.splice(t,1);AddFriendsLink(i.k,i.v)}}()</script></body></html>